(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[396],{3405:function(e,t,a){Promise.resolve().then(a.bind(a,6561))},6561:function(e,t,a){"use strict";a.r(t),a.d(t,{OrganizationExplore:function(){return O}});var r=a(1844),s=a(759),n=a(450),l=a(5784),i=a(2746),d=a(7927),o=a(5557);let c=d.fC,u=d.xz,x=l.forwardRef((e,t)=>{let{className:a,align:s="center",sideOffset:n=4,...l}=e;return(0,r.jsx)(d.h_,{children:(0,r.jsx)(d.VY,{ref:t,align:s,sideOffset:n,className:(0,o.cn)("z-50 w-72 rounded-md border border-slate-100 bg-white p-4 shadow-md outline-none animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=top]:slide-in-from-bottom-2 data-[side=right]:slide-in-from-left-2 data-[side=left]:slide-in-from-right-2 dark:border-slate-800 dark:bg-slate-800",a),...l})})});x.displayName=d.VY.displayName;let h=(0,l.createContext)({searchParams:{query_values:{},ignore_values:{}},setSearchParams:e=>{}}),g=e=>{let{searchParams:t,setSearchParams:a}=e;return(0,r.jsx)(h.Provider,{value:{searchParams:t,setSearchParams:a},children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-1 flex flex-wrap gap-y-2",children:e.children}),(0,r.jsx)("div",{children:(0,r.jsx)(s,{className:"w-6 h-6 text-gray-400"})})]})})},f=e=>(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{asChild:!0,children:(0,r.jsxs)("div",{className:"flex text-md font-medium mr-2 px-2 py-2 border border-gray-400 p-8 rounded-xl border-dashed gap-2 items-center",children:[e.active?(0,r.jsx)("span",{className:"flex w-3 h-3 bg-green-600 rounded-full"}):(0,r.jsx)(n,{className:"w-6 h-6 text-gray-400"}),(0,r.jsx)("span",{children:e.title})]})}),(0,r.jsx)(x,{children:e.children})]}),m=e=>{let t=(0,i.useTranslations)();return(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"w-full",children:(0,r.jsxs)("p",{children:[" ",t("filters.searchBy",{filter:e.title}),e.children]})})})};var p=a(3279),v=a.n(p),j=a(9196);let b=e=>{let{searchParams:t}=(0,l.useContext)(h);return(0,r.jsx)(f,{title:e.title,active:e.key_name in t,children:(0,r.jsx)(N,{...e})})},N=e=>{let{searchParams:t,setSearchParams:a}=(0,l.useContext)(h),s=v()(r=>{if(""===r){n();return}a({...t,[e.key_name]:r})},500),n=()=>{a(t=>{let a={...t};return delete a[e.key_name],a})};return(0,r.jsx)(m,{title:e.title,children:(0,r.jsx)(j.I,{defaultValue:t[e.key_name],onChange:e=>{s(e.target.value)}})})};var _=a(5820),y=a(6486);let k=e=>{let t={one_star_count:1,two_star_count:2,three_star_count:3,four_star_count:4,five_star_count:5},a=Object.entries(t).reduce((t,a)=>{let[r]=a;return t+e[r]},0),r=Object.entries(t).reduce((t,a)=>{let[r,s]=a;return t+e[r]*s},0);return{rating:a?(0,y.round)(r/a,1):0,count:a}};var w=a(7996),z=a(9630);let C=e=>(0,r.jsx)(i.Link,{href:"/organizations/".concat(e.org.id),className:"w-full lg:max-w-lg",children:(0,r.jsxs)("div",{className:"transition-all animate-in fade-in-10 w-full lg:max-w-lg bg-slate-50 rounded-xl h-54 p-4 shadow-md hover:-translate-y-1 hover:rounded-2xl",children:[(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)("h3",{className:"flex-1 text-lg font-light leading-tight tracking-tighter md:text-2xl lg:text-3xl lg:leading-[1.1]",children:e.org.attributes.name}),(0,r.jsx)("p",{children:"A 2 km"})]}),(0,r.jsx)(z.Separator,{}),(0,r.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,r.jsxs)("div",{className:"p-1 hidden md:inline",children:[(0,r.jsx)("div",{className:"stat-title",children:"Declaraciones"}),(0,r.jsx)("div",{className:"stat-value",children:e.org.attributes.tax_income_count}),(0,r.jsx)("div",{className:"stat-desc",children:"21% mas que el mes pasado"})]}),(0,r.jsxs)("div",{className:"p-1",children:[(0,r.jsx)("div",{className:"stat-title",children:"Rating"}),(0,r.jsx)("div",{className:"stat-value text-green-400",children:k(e.org.attributes.ratings).rating}),(0,r.jsx)("div",{className:"stat-desc",children:"Mejor que el 99%."})]}),(0,r.jsxs)("div",{className:"p-1",children:[(0,r.jsx)("div",{className:"stat-title",children:"Rango de precio"}),(0,r.jsx)("div",{className:"stat-value",children:(0,r.jsx)(R,{range:e.org.attributes.price_range})}),(0,r.jsx)("div",{className:"stat-desc",children:"Mejor que el 99%."})]})]})]})}),R=e=>{switch(e.range){case 0:return(0,r.jsx)("span",{children:"€"});case 1:return(0,r.jsx)("span",{children:"€€"});case 2:return(0,r.jsx)("span",{children:"€€€"});default:return(0,r.jsx)("span",{children:"∅"})}};var E=a(6594);let S=e=>{var t;let[a,s]=(0,l.useState)(0),n=(0,i.useTranslations)(),d=null!==(t=e.messages)&&void 0!==t?t:[n("global.loading"),n("global.loading2")];return(0,l.useEffect)(()=>{let e=setInterval(()=>{s((a+1)%d.length)},2500);return()=>clearInterval(e)}),(0,r.jsx)("div",{className:"grid h-full place-items-center",children:(0,r.jsx)("div",{className:"grid grid-cols-1 mx-auto",children:(0,r.jsx)("p",{className:"animate-pulse text-xl font-bold",children:d[a]})})})},I=()=>{let{searchParams:e}=(0,l.useContext)(h);return(0,r.jsx)(f,{title:"Location",active:"coordinates"in e,children:(0,r.jsx)(P,{})})},P=()=>{let{searchParams:e,setSearchParams:t}=(0,l.useContext)(h),[a,s]=(0,l.useState)(!1),n=(0,i.useTranslations)(),d=a=>{a.value.place_id&&(0,E.I7)(a.value.place_id).then(a=>{t({...e,"coordinates[place_name]":a[0].formatted_address,"coordinates[place_id]":a[0].place_id,"coordinates[latitude]":a[0].geometry.location.lat(),"coordinates[longitude]":a[0].geometry.location.lng(),"coordinates[status]":"dir"})}).catch(e=>console.error(e))},o=()=>{t({...e,"coordinates[status]":"loading"}),navigator.geolocation.getCurrentPosition(function(a){(0,E.$0)({lat:a.coords.latitude,lng:a.coords.longitude}).then(r=>{t({...e,"coordinates[place_name]":r[0].formatted_address,"coordinates[place_id]":r[0].place_id,"coordinates[latitude]":a.coords.latitude,"coordinates[longitude]":a.coords.longitude,"coordinates[status]":"live"})}).catch(e=>console.error(e))},function(e){c()})},c=()=>{t(e=>{let t={...e};return delete t["coordinates[latitude]"],delete t["coordinates[longitude]"],delete t["coordinates[distance]"],delete t["coordinates[status]"],delete t["coordinates[place_name]"],delete t["coordinates[place_id]"],t})};return(0,l.useEffect)(()=>{"geolocation"in navigator&&s(!0)},[]),(0,r.jsx)(m,{title:"location",children:(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"w-64",children:[(0,r.jsx)("div",{className:"",children:(0,r.jsx)(E.ZP,{selectProps:{value:{label:e["coordinates[place_name]"],value:{place_id:e["coordinates[place_object]"]}},onChange:d},autocompletionRequest:{componentRestrictions:{country:["es"]}},apiKey:"AIzaSyAVJ4unu6x9VcFQHkyxHv_3DQyaR4zIuic"})}),(0,r.jsx)("div",{children:e["coordinates[status]"]?(0,r.jsx)(w.z,{onClick:c,color:"error",size:"sm",children:n("global.disable")}):"loading"===e["coordinates[status]"]?(0,r.jsx)(S,{}):(0,r.jsx)(w.z,{size:"sm",onClick:o,disabled:!a,children:"Locate me"})})]})})})},O=()=>{let[e,t]=(0,l.useState)({}),{data:a}=(0,_.g)(e);return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)(g,{searchParams:e,setSearchParams:t,children:[(0,r.jsx)(b,{key_name:"name",title:"Buscar por nombre"},"name"),(0,r.jsx)(I,{})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-4",children:a&&(null==a?void 0:a.map(e=>(0,r.jsx)(C,{org:e},e.id)))})]})}},7996:function(e,t,a){"use strict";a.d(t,{d:function(){return i},z:function(){return d}});var r=a(1844),s=a(5784),n=a(1942),l=a(5557);let i=(0,n.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 dark:hover:bg-slate-800 dark:hover:text-slate-100 disabled:opacity-50 dark:focus:ring-slate-400 disabled:pointer-events-none dark:focus:ring-offset-slate-900 data-[state=open]:bg-slate-100 dark:data-[state=open]:bg-slate-800",{variants:{variant:{default:"bg-slate-900 text-white hover:bg-slate-700 dark:bg-slate-50 dark:text-slate-900",destructive:"bg-red-500 text-white hover:bg-red-600 dark:hover:bg-red-600",outline:"bg-transparent border border-slate-200 hover:bg-slate-100 dark:border-slate-700 dark:text-slate-100",subtle:"bg-slate-100 text-slate-900 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-100",ghost:"bg-transparent hover:bg-slate-100 dark:hover:bg-slate-800 dark:text-slate-100 dark:hover:text-slate-100 data-[state=open]:bg-transparent dark:data-[state=open]:bg-transparent",link:"bg-transparent underline-offset-4 hover:underline text-slate-900 dark:text-slate-100 hover:bg-transparent dark:hover:bg-transparent"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-2 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:n,...d}=e;return(0,r.jsx)("button",{className:(0,l.cn)(i({variant:s,size:n,className:a})),ref:t,...d})});d.displayName="Button"},9196:function(e,t,a){"use strict";a.d(t,{I:function(){return l}});var r=a(1844),s=a(5784),n=a(5557);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("input",{className:(0,n.cn)("flex h-10 w-full rounded-md border border-slate-300 bg-transparent py-2 px-3 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-700 dark:text-slate-50 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900",a),ref:t,...s})});l.displayName="Input"},9630:function(e,t,a){"use strict";a.r(t),a.d(t,{Separator:function(){return i}});var r=a(1844),s=a(5784),n=a(2090),l=a(5557);let i=s.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:i=!0,...d}=e;return(0,r.jsx)(n.f,{ref:t,decorative:i,orientation:s,className:(0,l.cn)("bg-slate-200 dark:bg-slate-700","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...d})});i.displayName=n.f.displayName},5557:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});var r=a(8642),s=a(7851);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m)((0,r.W)(t))}},5820:function(e,t,a){"use strict";a.d(t,{g:function(){return d},h:function(){return i}});var r=a(848),s=a(5673),n=a(8858),l=a(4887);let i=(0,r.LC)({reducerPath:"api",extractRehydrationInfo(e,t){let{reducerPath:a}=t;if(e.type===n.ju)return e.payload[a]},baseQuery:(0,s.ni)({baseUrl:"http://localhost:3000/api/v1",credentials:"include",paramsSerializer:e=>l.Z.stringify(e,{arrayFormat:"bracket"})}),tagTypes:["Organization","AUTHENTICATED_USER","User","WEB_AUTHN_KEYS"],endpoints:e=>({getOrganizations:e.query({query:e=>({url:"organizations",params:e,method:"get"}),transformResponse:e=>e.data})})}),{useGetOrganizationsQuery:d}=i}},function(e){e.O(0,[662,691,424,612,989,390,17,744],function(){return e(e.s=3405)}),_N_E=e.O()}]);